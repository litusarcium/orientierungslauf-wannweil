<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Festpostennetz Wannweil</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #2E7D32; /* Waldgr√ºn */
        }
        .qr-list {
            margin-top: 20px;
        }
        .qr-item {
            padding: 12px;
            margin: 10px auto;
            width: 250px;
            border-radius: 8px;
            background-color: #2E7D32; /* Waldgr√ºn */
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.2);
        }
        .reset-btn {
            margin-top: 20px;
            padding: 10px 15px;
            font-size: 16px;
            border: none;
            background-color: #C62828; /* Rot */
            color: white;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.2);
        }
        .reset-btn:hover {
            background-color: #B71C1C; /* Dunkleres Rot */
        }
        /* Stil f√ºr das Bild in der rechten oberen Ecke */
.corner-image {
    position: fixed;
    top: 10px;
    right: 10px;
    width: 60px; /* Gr√∂√üe des Bildes */
    height: auto;
}
    </style>
</head>
<body>

    <h1>Festpostennetz Wannweil</h1>
    <img src="logo.png" alt="Logo" class="corner-image">
    <p>Wenn du die QR-Codes an den Posten scannst, erscheinen sie hier.
    So erh√§lst du deinen Lauffortschritt.
    Bitt benutze kein Privat-Tab, sonst funktioniert das Speichern nicht!

    </p>

    <div id="qrContainer" class="qr-list"></div>

    <button class="reset-btn" onclick="resetProgress()">üîÑ Fortschritt zur√ºcksetzen</button>

    
        
        <script>
    // Fortschritt aus localStorage laden
    let scannedCodes = JSON.parse(localStorage.getItem("qrProgress")) || [];
    let timeStamps = JSON.parse(localStorage.getItem("qrTimestamps")) || [];

    // Pr√ºfen, ob ein Code in der URL steht
    const urlParams = new URLSearchParams(window.location.search);
    const scannedCode = urlParams.get("code");

    if (scannedCode && !scannedCodes.includes(scannedCode)) {
        let currentTime = new Date().getTime(); // Aktuelle Zeit in Millisekunden

        // Falls es schon einen vorherigen Scan gab, Differenz berechnen
        let timeDiffMS = timeStamps.length > 0 
            ? currentTime - timeStamps[timeStamps.length - 1] 
            : 0; // Erste Zeit = 0

        let minutes = Math.floor(timeDiffMS / 60000); // Ganze Minuten
        let seconds = Math.floor((timeDiffMS % 60000) / 1000); // Restliche Sekunden

        let timeDiffFormatted = minutes + ":" + (seconds < 10 ? "0" : "") + seconds; // Format MM:SS

        scannedCodes.push(scannedCode);
        timeStamps.push(currentTime);

        // Daten speichern
        localStorage.setItem("qrProgress", JSON.stringify(scannedCodes));
        localStorage.setItem("qrTimestamps", JSON.stringify(timeStamps));

        alert(`‚úÖ QR-Code ${scannedCode} erfolgreich gescannt! (${timeDiffFormatted} Min.)`);
    }

    // UI aktualisieren
    function updateQRList() {
        const container = document.getElementById("qrContainer");
        container.innerHTML = "";
        
        scannedCodes.forEach((code, index) => {
            let timeDiffFormatted = "0:00"; // Standard f√ºr den ersten Code
            
            if (index > 0) {
                let timeDiffMS = timeStamps[index] - timeStamps[index - 1];
                let minutes = Math.floor(timeDiffMS / 60000);
                let seconds = Math.floor((timeDiffMS % 60000) / 1000);
                timeDiffFormatted = minutes + ":" + (seconds < 10 ? "0" : "") + seconds;
            }

            const div = document.createElement("div");
            div.className = "qr-item";
            div.innerText = `üìç Punkt ${code} (${timeDiffFormatted} Min.)`;
            container.appendChild(div);
        });
    }

    // Fortschritt zur√ºcksetzen
    function resetProgress() {
        localStorage.removeItem("qrProgress");
        localStorage.removeItem("qrTimestamps");
        scannedCodes = [];
        timeStamps = [];
        updateQRList();
    }

    updateQRList();
</script>


</body>
</html>
